define(function(require,d,a){var c=window.BrowserStorage||{version:"1.3"};c.localStorage=(function(){function e(k){var k=k||{};window.localStorage.setItem(k.key,k.value);if(k.expires){var j;if("number"==typeof k.expires){j=new Date();j.setTime(j.getTime()+k.expires)}window.localStorage.setItem(k.key+".expires",j||k.expires)}}function i(j){var l=null;if(typeof j==="string"){j={key:j}}l=window.localStorage.getItem(j.key);if(l){var k=window.localStorage.getItem(j.key+".expires");l={value:l,expires:k?new Date(k):null};if(l&&l.expires&&l.expires<new Date()){l=null;window.localStorage.removeItem(j.key);window.localStorage.removeItem(j.key+".expires")}}return l?l.value:null}function h(j){window.localStorage.removeItem(j.key);window.localStorage.removeItem(j.key+".expires")}function g(){window.localStorage.clear()}function f(){var m=[],l;for(var k=0,j=window.localStorage.length;k<j;k++){l=window.localStorage.key(k);if(!/.+\.expires$/.test(l)){m.push(l)}}return m}return{get:i,set:e,remove:h,clearAll:g,getAllKeys:f}})();c.userData=(function(){var l="_baidu.ALL.KEY_";function g(){var m=null;m=document.createElement("input");m.type="hidden";m.addBehavior("#default#userData");document.body.appendChild(m);return m}function f(n){try{var m=g();var q=n||{};if(q.expires){var o;if("number"==typeof q.expires){o=new Date();o.setTime(o.getTime()+q.expires)}o=(o||q.expires);m.expires=o.toUTCString()}m.setAttribute(q.key,q.value);m.save(q.key)}catch(p){}}function e(m){f(m);var n=k({key:l});if(n){n={key:l,value:n}}else{n={key:l,value:""}}if(!(new RegExp("(^|\\|)"+m.key+"(\\||$)","g")).test(n.value)){n.value+="|"+m.key;f(n)}}function k(n){try{var m=g();m.load(n.key);return m.getAttribute(n.key)||null}catch(o){return null}}function j(n){try{var m=g();m.load(n.key);m.removeAttribute(n.key);var o=new Date();o.setTime(o.getTime()-1);m.expires=o.toUTCString();m.save(n.key);var p=k({key:l});if(p){p=p.replace(new RegExp("(^|\\|)"+n.key+"(\\||$)","g"),"");p={key:l,value:p};f(p)}}catch(q){}}function i(){result=k({key:l});if(result){var m=result.split("|");var o=m.length;for(var n=0;n<o;n++){if(!!m[n]){j({key:m[n]})}}}}function h(){var p=[];var o=k({key:l});if(o){o=o.split("|");for(var n=0,m=o.length;n<m;n++){if(!!o[n]){p.push(o[n])}}}return p}return{get:k,set:e,remove:j,clearAll:i,getAllKeys:h}})();c.cookie=(function(){var j=function(k){return(new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+\x24')).test(k)};var i=function(k){var n=null;if(j(k.key)){var l=new RegExp("(^| )"+k.key+"=([^;/]*)([^;\x24]*)(;|\x24)"),m=l.exec(document.cookie);if(m){n=m[2]||null}}if(("string"==typeof n)&&k.decode!=false){n=decodeURIComponent(n);return n}return null};var e=function(k){if(!j(k.key)){return}k=k||{};if(k.encode!=false){k.value=encodeURIComponent(k.value)}var l=k.expires;if(!(l instanceof Date)){l=new Date();if("number"==typeof k.expires){l.setTime(l.getTime()+k.expires*1000)}else{l.setTime(l.getTime()+86400000*30)}}document.cookie=k.key+"="+k.value+("; path="+(k.path?(k.path=="./"?"":k.path):"/"))+(l?"; expires="+l.toGMTString():"")+(k.domain?"; domain="+k.domain:"")+(k.secure?"; secure":"")};var h=function(k){var l=i(k);if(l!=null){k.value=null;k.expires=-1;e(k)}};var g=function(){document.cookie=""};var f=function(){var o=[];var n=/(^| )([^=; ]+)=([^;]*)(;|\x24)/igm;var p=(document.cookie||"").match(n);if(p){var l;for(var m=0,k=p.length;m<k;m++){l=n.exec(p[m]);o.push(l[2])}}return o};return{get:i,set:e,remove:h,clearAll:g,getAllKeys:f}})();c.api=(function(){var l=(function(){var n=navigator.userAgent.toLowerCase();return{version:(n.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[])[1],safari:/webkit/.test(n),opera:/opera/.test(n),msie:/msie/.test(n)&&!/opera/.test(n),mozilla:/mozilla/.test(n)&&!/(compatible|webkit)/.test(n)}})();var h=function(){var n=false;try{n=("localStorage" in window)&&(window.localStorage.getItem)}catch(o){n=false}return n};var g=function(){return l.msie};var k=function(n){return(new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+\x24')).test(n)};var e=function(r,q){var o=function(s){if(!k(s.key)){return}var t=s.expires;if(!(t instanceof Date)){t=new Date();if("number"==typeof s.expires){t.setTime(t.getTime()+(s.expires*1000))}else{t.setTime(t.getTime()+86400*30*1000)}}s.expires=t;if(h()){c.localStorage.set(s)}else{if(g()&&q){c.userData.set(s)}else{c.cookie.set(s)}}};if(r&&r.constructor===Array&&r instanceof Array){for(var p=0,n=r.length;p<n;p++){o(r[p])}}else{if(r){o(r)}}};var f=function(r,q){var p=function(t){var u=null;if(typeof t==="string"){t={key:t}}if(!k(t.key)){return u}if(h()){u=c.localStorage.get(t)}else{if(g()&&q){u=c.userData.get(t)}else{u=c.cookie.get(t)}}return{key:t.key,value:u}};var s=null;if(r&&r.constructor===Array&&r instanceof Array){s=[];for(var o=0,n=r.length;o<n;o++){s.push(p(r[o]))}}else{if(r){s=p(r)}}return s};var m=function(r,p){var q=function(s){if(typeof s==="string"){s={key:s}}if(!k(s.key)){return result}if(h()){c.localStorage.remove(s)}else{if(g()&&p){c.userData.remove(s)}else{c.cookie.remove(s)}}};if(r&&r.constructor===Array&&r instanceof Array){for(var o=0,n=r.length;o<n;o++){q(r[o])}}else{if(r){q(r)}}};var j=function(n){if(h()){c.localStorage.clearAll()}else{if(g()&&n){c.userData.clearAll()}else{c.cookie.clearAll()}}};var i=function(n){var o=null;if(h()){o=c.localStorage.getAllKeys()}else{if(g()&&n){o=c.userData.getAllKeys()}else{o=c.cookie.getAllKeys()}}return o};return{get:f,set:e,remove:m,clearAll:j,getAllKeys:i}})();a.exports=c.api});